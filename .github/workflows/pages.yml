name: Scheduled E2E Trigger

on:
  schedule:
    - cron: '0 0 * * 0'  # Weekly on Sunday at midnight UTC
  workflow_dispatch:
    inputs:
      axon_version:
        description: 'Axon version to test'
        required: false
        default: 'v3.1.7'
      core_version:
        description: 'Core version to test'
        required: false
        default: '4.1.0-alpha'

# This workflow triggers the main E2E Parallel Pipeline
# which handles both testing and GitHub Pages deployment

jobs:
  trigger-e2e:
    name: Trigger E2E Parallel Pipeline
    runs-on: ubuntu-latest
    steps:
      - name: Trigger E2E Parallel Pipeline
        uses: actions/github-script@v7
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const axonVersion = '${{ github.event.inputs.axon_version || 'v3.1.7' }}';
            const coreVersion = '${{ github.event.inputs.core_version || '4.1.0-alpha' }}';

            console.log(`Triggering E2E Parallel Pipeline with:`);
            console.log(`  Axon: ${axonVersion}`);
            console.log(`  Core: ${coreVersion}`);

            await github.rest.actions.createWorkflowDispatch({
              owner: context.repo.owner,
              repo: context.repo.repo,
              workflow_id: 'e2e-parallel.yml',
              ref: 'main',
              inputs: {
                axon_version: axonVersion,
                core_version: coreVersion
              }
            });

            console.log('E2E Parallel Pipeline triggered successfully');
